---
title: "R Notebook"
output: Species Comparisons
---

Goal: Compare the lat vs length of all 7 species of interest.

```{r}
load("blackSB_table.RData")
load("lookdown_table.RData")
load("boxcrab_table.RData")
load("puffer_table.RData")
load("LFsquid_table.RData")
load("hammerhead_table.RData")
load("sunfish_table.RData")
library(dplyr)
library(data.table)
library(stringr)
library(tibble)
library(ggplot2)
library(lubridate)
```

Remove exess years
```{r}
#cut off before 1989 b/c seus starts last (1989)
blackSB_table[ , YEAR := year(DATE)]
blackSB_table2 <- blackSB_table[YEAR>1989]

lookdown_table[ , YEAR := year(DATE)]
lookdown_table2 <- lookdown_table[YEAR>1989]

boxcrab_table[ , YEAR := year(DATE)]
boxcrab_table2 <- boxcrab_table[YEAR>1989]

puffer_table[ , YEAR := year(DATE)]
puffer_table2 <- puffer_table[YEAR>1989]

LFsquid_table[ , YEAR := year(DATE)]
LFsquid_table2 <- LFsquid_table[YEAR>1989]

hammerhead_table[ , YEAR := year(DATE)]
hammerhead_table2 <- hammerhead_table[YEAR>1989]

sunfish_table[ , YEAR := year(DATE)]
sunfish_table2 <- sunfish_table[YEAR>1989]
```

Lat vs length graphs
```{r}
ggplot(blackSB_table2, aes(x=LATITUDE, y=LENGTH)) +
  geom_point() +
  geom_smooth(method=lm) +
  theme_classic()

ggplot(lookdown_table2, aes(x=LATITUDE, y=LENGTH)) +
  geom_point() +
  geom_smooth(method=lm) +
  theme_classic()

ggplot(boxcrab_table2, aes(x=LATITUDE, y=LENGTH)) +
  geom_point() +
  geom_smooth(method=lm) +
  theme_classic()

ggplot(puffer_table2, aes(x=LATITUDE, y=LENGTH)) +
  geom_point() +
  geom_smooth(method=lm) +
  theme_classic()

ggplot(LFsquid_table2, aes(x=LATITUDE, y=LENGTH)) +
  geom_point() +
  geom_smooth(method=lm) +
  theme_classic()

ggplot(hammerhead_table2, aes(x=LATITUDE, y=LENGTH)) +
  geom_point() +
  geom_smooth(method=lm) +
  theme_classic()

ggplot(sunfish_table2, aes(x=LATITUDE, y=LENGTH)) +
  geom_point() +
  geom_smooth(method=lm) +
  theme_classic()
```

Models for each of the above graphs.
```{r}
blackSB_model <- lm(LENGTH~LATITUDE, data = blackSB_table2)
summary(blackSB_model)
#length = -0.100388 * lat + 115.786587
#good p-value, bar r2

lookdown_model <- lm(LENGTH~LATITUDE, data = lookdown_table2)
summary(lookdown_model)
#len = -2.73 * lat + 225.977 
# good p-value, bar r2

boxcrab_model <- lm(LENGTH~LATITUDE, data = boxcrab_table2)
summary(boxcrab_model)
#len = 2.78 * lat + 39.032
#good p-value, bar r2

puffer_model <- lm(LENGTH~LATITUDE, data = puffer_table2)
summary(puffer_model)
#len = -0.08897 * lat + 139.92
# good p-values, really bad r2

LFsquid_model <- lm(LENGTH~LATITUDE, data = LFsquid_table2)
summary(LFsquid_model)
#len = -0.006517 * lat + 35.16
#good p-value, bar r2

hammerhead_model <- lm(LENGTH~LATITUDE, data = hammerhead_table2)
summary(hammerhead_model)
#len = -1.144 * lat + 173.0498
# good p-values, really bad r2
```

